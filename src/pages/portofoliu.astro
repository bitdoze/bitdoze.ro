---
import Layout from "../layouts/Layout.astro";
import { Icon } from "astro-icon/components";
import { getCollection } from "astro:content";
import PortofolioCard from "../components/PortofolioCard.astro";
import PageHeader from "../components/PageHeader.astro";
import CTA from "../components/CTA.astro";

// Get all non-draft portfolio entries
const portofoliu = await getCollection("portofoliu", ({ data }) => {
  return !data.draft;
});

// Sort by date in descending order
const sortedProjects = portofoliu.sort(
  (a, b) => b.data.data.getTime() - a.data.data.getTime()
);
---

<Layout
  title="Portofoliu - BitDoze"
  description="Explorați portofoliul nostru de proiecte web și descoperiți soluțiile digitale personalizate pe care le-am creat pentru clienții noștri."
  ogType="website"
>
  <!-- Hero Section -->
  <PageHeader
    title="Portofoliu"
    subtitle="Explorați colecția noastră de proiecte și descoperiți diversitatea soluțiilor digitale pe care le oferim."
    align="center"
    withBlobs={true}
    withGrid={true}
    icon="mdi:folder-multiple-image"
  />

  <!-- Portfolio Section -->
  <section class="section-padding">
    <div class="container">
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        {
          sortedProjects.map((project) => (
            <div class="portfolio-item">
              <PortofolioCard
                title={project.data.title}
                descriere={project.data.descriere}
                imagine={project.data.imagine}
                url={project.data.url}
                stack={project.data.stack}
                servicii={project.data.servicii}
                slug={project.slug}
              />
            </div>
          ))
        }
      </div>

      <!-- Empty State -->
      {
        sortedProjects.length === 0 && (
          <div
            class="text-center py-20 px-6 rounded-2xl bg-white"
            style="box-shadow: var(--shadow-md);"
          >
            <Icon
              name="mdi:folder-open-outline"
              class="h-20 w-20 mx-auto mb-6"
              style="color: var(--color-text-lighter);"
            />
            <h3 class="text-2xl font-semibold mb-3">
              Niciun proiect disponibil
            </h3>
            <p style="color: var(--color-text-light);" class="max-w-md mx-auto">
              Proiectele vor fi adăugate în curând. Reveniți mai târziu pentru a
              vedea portofoliul nostru.
            </p>
          </div>
        )
      }
    </div>
  </section>

  <!-- CTA Section -->
  <CTA
    title="Pregătit să duci afacerea ta la următorul nivel?"
    subtitle="Contactează-ne astăzi pentru o consultație gratuită și descoperă cum serviciile noastre pot accelera creșterea afacerii tale."
    ctaText="Contactează-ne acum"
    ctaLink="/contact"
    secondaryText="Află mai multe"
    secondaryLink="/about"
    trustedBy="De încredere pentru companii de top din România"
  />
</Layout>
